{% extends 'base.html' %}
{% load static %}

{% block title %}Избранное{% endblock %}

{% block content %}
<div class="container">
    <style>
    .card.fav-card {
    max-width: 240px;   /* ← сузили карточку до примерно телефона */
    margin: 0 auto;     /* центрируем по горизонтали */
    }
    .card.fav-card .card-img-top {
        border-radius: 0;
    }
        /* --- компактные кнопки --- */

    /* --- меньший промежуток между карточками --- */
    .row.g-2 {          /* ставим на родительский .row */
        --bs-gutter-x: 0.5rem;   /* горизонтальный зазор */
        --bs-gutter-y: 0.5rem;   /* вертикальный зазор */
    }
    /* общая высота плитки */
    .fav-grid {
        display: flex;
        flex-wrap: wrap;
        gap: 0.5rem;          /* тот же g-2 */
    }
    .fav-item {
        flex: 0 0 calc(16.666% - 0.5rem);   /* 6 в ряд (col-lg-2) */
        display: flex;
    }
    .fav-card {
    width: 100%;
    height: 430px;        /* было 400px → +30px */
    display: flex;
    flex-direction: column;
    border: 1px solid rgba(255,255,255,.15);
    border-radius: 8px;
    box-shadow: 0 2px 6px rgba(0,0,0,.25);
    overflow: hidden;
    }
    .fav-card .card-img-top {
    height: 330px;              /* чуть ниже – меньше обрезки */
    object-fit: cover;
    object-position: center top; /* показываем верх, не трогаем низ */
    border-radius: 8px 8px 0 0;
    }
    .fav-card .card-body {
        flex: 1 0 auto;
        display: flex;
        flex-direction: column;
        justify-content: space-between;
        padding: 10px 12px;   /* чуть меньше внутреннего отступа */
    }
    /* миниатюрные кнопки оставляем */
    .btn-xxs { padding: 2px 6px; font-size: 0.7rem; }
        /* поднимаем кнопки выше */
    .fav-card .card-body {
    flex: 1 0 auto;
    display: flex;
    flex-direction: column;
    justify-content: flex-start; /* ← вверх */
    padding: 10px 12px;
    gap: 6px;
    }
    /* убираем «прилипание» к низу */
    .fav-card .card-body .d-flex {
        margin-top: 0; /* ← убрали auto */
    }
    </style>
    <h2 class="mb-4"><i class="fas fa-star me-2"></i>Избранное</h2>

    {% if favorites %}
        <div class="row g-2 fav-grid">
          {% for favorite in favorites %}
          <div class="fav-item">
            <div class="card fav-card">
              {% if favorite.movie.poster %}
                <img src="{{ favorite.movie.poster.url }}"
                     class="card-img-top"
                     alt="{{ favorite.movie.title }}">
              {% else %}
                <div class="card-img-top bg-secondary d-flex align-items-center justify-content-center">
                  <i class="fas fa-film fa-2x text-light"></i>
                </div>
              {% endif %}

              <div class="card-body">
                <h6 class="card-title mb-1">{{ favorite.movie.title|truncatechars:18 }}</h6>
                <small class="text-muted d-block mb-2">{{ favorite.movie.year }}</small>

                <div class="d-flex justify-content-between gap-1">
                  <a href="{% url 'movie_detail' favorite.movie.id %}" class="btn btn-primary btn-sm">Смотреть</a>
                  <form action="{% url 'remove_from_favorites' favorite.movie.id %}" method="post" class="d-inline">
                    {% csrf_token %}
                    <button type="submit" class="btn btn-outline-danger btn-sm">Удалить</button>
                  </form>
                </div>
              </div>
            </div>
          </div>
          {% endfor %}
        </div>
    {% else %}
        <div class="alert alert-info">
            <i class="fas fa-info-circle me-2"></i>
            У вас пока нет избранных фильмов.
        </div>
        <a href="{% url 'movie_list' %}" class="btn btn-primary">
            <i class="fas fa-film me-2"></i>Найти фильмы
        </a>
    {% endif %}
</div>
{% endblock %}