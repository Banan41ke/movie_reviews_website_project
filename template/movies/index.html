{% load static %}
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Movie Reviews - –õ—É—á—à–∏–µ —Ñ–∏–ª—å–º—ã</title>
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script>
        // –ü—Ä–æ—Å—Ç–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–∏—Å–∫–∞
        function searchMovies() {
            const query = document.querySelector('.search-bar input').value.toLowerCase();
            const cards = document.querySelectorAll('.movie-card');

            cards.forEach(card => {
                const title = card.querySelector('.movie-title').textContent.toLowerCase();
                if (title.includes(query)) {
                    card.style.display = 'block';
                } else {
                    card.style.display = 'none';
                }
            });
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        document.addEventListener('DOMContentLoaded', function() {
            // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –ø–æ–∏—Å–∫–∞
            document.querySelector('.search-bar input').addEventListener('input', searchMovies);

            // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∂–∞–Ω—Ä–∞–º
            document.querySelectorAll('.genre-list a').forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    document.querySelectorAll('.genre-list a').forEach(a => a.classList.remove('active'));
                    this.classList.add('active');

                    const genre = this.textContent.toLowerCase();
                    if (genre.includes('–≤—Å–µ')) {
                        document.querySelectorAll('.movie-card').forEach(card => {
                            card.style.display = 'block';
                        });
                    }
                });
            });
        });
    </script>
</head>
<body>
    <div class="container">
        <!-- –®–ê–ü–ö–ê -->
        <header>
            <h1><i class="fas fa-film"></i> MOVIE REVIEWS</h1>
            <p class="tagline">–û—Ç–∫—Ä–æ–π—Ç–µ –¥–ª—è —Å–µ–±—è –ª—É—á—à–∏–µ —Ñ–∏–ª—å–º—ã –∏ –ø–æ–¥–µ–ª–∏—Ç–µ—Å—å —Å–≤–æ–∏–º –º–Ω–µ–Ω–∏–µ–º</p>
            <div class="search-bar">
                <input type="text" placeholder="üîç –ü–æ–∏—Å–∫ —Ñ–∏–ª—å–º–æ–≤..." onkeyup="searchMovies()">
            </div>
        </header>

        <!-- –û–°–ù–û–í–ù–û–ô –ö–û–ù–¢–ï–ù–¢ -->
        <main>
            <!-- –°–ê–ô–î–ë–ê–† –° –ñ–ê–ù–†–ê–ú–ò -->
            <aside class="genres-sidebar">
                <h3><i class="fas fa-tags"></i> –ñ–∞–Ω—Ä—ã</h3>
                <ul class="genre-list">
                    <li><a href="#" class="active"><span class="genre-icon">üé¨</span> –í—Å–µ —Ñ–∏–ª—å–º—ã</a></li>
                    <li><a href="#"><span class="genre-icon">üí•</span> –ë–æ–µ–≤–∏–∫</a></li>
                    <li><a href="#"><span class="genre-icon">üòÇ</span> –ö–æ–º–µ–¥–∏—è</a></li>
                    <li><a href="#"><span class="genre-icon">üò¢</span> –î—Ä–∞–º–∞</a></li>
                    <li><a href="#"><span class="genre-icon">üöÄ</span> –§–∞–Ω—Ç–∞—Å—Ç–∏–∫–∞</a></li>
                    <li><a href="#"><span class="genre-icon">üî™</span> –¢—Ä–∏–ª–ª–µ—Ä</a></li>
                    <li><a href="#"><span class="genre-icon">‚ù§Ô∏è</span> –ú–µ–ª–æ–¥—Ä–∞–º–∞</a></li>
                    <li><a href="#"><span class="genre-icon">üëª</span> –£–∂–∞—Å—ã</a></li>
                </ul>
            </aside>

            <!-- –ö–û–ù–¢–ï–ô–ù–ï–† –§–ò–õ–¨–ú–û–í -->
            <div class="movies-container">
                <div class="movies-header">
                    <h2><i class="fas fa-fire"></i> –ü–û–ü–£–õ–Ø–†–ù–´–ï –§–ò–õ–¨–ú–´</h2>
                    <span class="movies-count">{{ movies|length }} —Ñ–∏–ª—å–º–æ–≤</span>
                </div>

                <!-- –°–ï–¢–ö–ê –§–ò–õ–¨–ú–û–í -->
                <div class="movie-grid">
                    {% for movie in movies %}
                    <!-- –ö–ê–†–¢–û–ß–ö–ê –§–ò–õ–¨–ú–ê - –ö–õ–ò–ö–ê–ë–ï–õ–¨–ù–ê–Ø! -->
                    <a href="/movies/{{ movie.id }}/" class="movie-card">
                        <!-- –†–ï–ô–¢–ò–ù–ì -->
                        <div class="rating-badge {% if movie.avg_rating >= 8 %}rating-high{% elif movie.avg_rating >= 6 %}rating-medium{% else %}rating-low{% endif %}">
                            <i class="fas fa-star"></i>
                            <span>{{ movie.avg_rating|default:"0.0" }}</span>
                        </div>

                        <!-- –ü–û–°–¢–ï–† -->
                        <div class="poster-container">
                            <img src="{{ movie.poster.url }}"
                                 alt="{{ movie.title }}"
                                 class="movie-poster"
                                 onerror="this.onerror=null; this.src='https://via.placeholder.com/300x450/2C3E50/FFFFFF?text={{ movie.title|urlencode }}'">
                            <div class="poster-overlay">
                                <button class="watch-now-btn" onclick="event.preventDefault(); alert('–¢—Ä–µ–π–ª–µ—Ä –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω —Å–∫–æ—Ä–æ!');">
                                    <i class="fas fa-play"></i> –°–º–æ—Ç—Ä–µ—Ç—å
                                </button>
                            </div>
                        </div>

                        <!-- –ò–ù–§–û–†–ú–ê–¶–ò–Ø –û –§–ò–õ–¨–ú–ï -->
                        <div class="movie-info">
                            <h3 class="movie-title">{{ movie.title }}</h3>

                            <div class="movie-meta">
                                <span class="year"><i class="far fa-calendar"></i> {{ movie.year }}</span>
                                <span class="duration"><i class="far fa-clock"></i> {{ movie.duration|default:"120" }} –º–∏–Ω</span>
                            </div>

                            <!-- –ñ–ê–ù–†–´ -->
                            <div class="movie-genres">
                                {% for genre in movie.genres|slice:":3" %}
                                <span class="genre-tag">{{ genre }}</span>
                                {% endfor %}
                            </div>

                            <!-- –†–ï–ô–¢–ò–ù–ì –ó–í–ï–ó–î–ê–ú–ò -->
                            <div class="star-rating">
                                {% with rating=movie.avg_rating|default:0 %}
                                {% for i in "12345" %}
                                    {% if forloop.counter <= rating|floatformat:0 %}
                                        <i class="fas fa-star"></i>
                                    {% else %}
                                        <i class="far fa-star"></i>
                                    {% endif %}
                                {% endfor %}
                                <span class="rating-text">({{ movie.reviews_count|default:"0" }})</span>
                                {% endwith %}
                            </div>

                            <!-- –û–ü–ò–°–ê–ù–ò–ï -->
                            <p class="movie-description">
                                {{ movie.description|truncatechars:120|default:"–û–ø–∏—Å–∞–Ω–∏–µ —Ñ–∏–ª—å–º–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç." }}
                            </p>

                            <!-- –ö–ù–û–ü–ö–ê –ü–û–î–†–û–ë–ù–ï–ï -->
                            <div class="card-action-btn">
                                <i class="fas fa-info-circle"></i> –ü–æ–¥—Ä–æ–±–Ω–µ–µ –æ —Ñ–∏–ª—å–º–µ
                            </div>
                        </div>
                    </a>
                    {% empty %}
                    <!-- –ï–°–õ–ò –§–ò–õ–¨–ú–û–í –ù–ï–¢ -->
                    <div style="grid-column: 1 / -1; text-align: center; padding: 50px;">
                        <i class="fas fa-film fa-4x" style="color: rgba(255,255,255,0.1); margin-bottom: 20px;"></i>
                        <h3>–§–∏–ª—å–º—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</h3>
                        <p style="color: #aaa;">–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –≤—ã–±—Ä–∞—Ç—å –¥—Ä—É–≥–æ–π –∂–∞–Ω—Ä</p>
                    </div>
                    {% endfor %}
                </div>
            </div>
        </main>

        <!-- –§–£–¢–ï–† -->
        <footer>
            <div class="footer-links">
                <a href="#" onclick="alert('–°—Ç—Ä–∞–Ω–∏—Ü–∞ –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ')">–û –ø—Ä–æ–µ–∫—Ç–µ</a>
                <a href="#" onclick="alert('–°–≤—è–∂–∏—Ç–µ—Å—å —Å –Ω–∞–º–∏: contact@moviereviews.ru')">–ö–æ–Ω—Ç–∞–∫—Ç—ã</a>
                <a href="#" onclick="alert('–ü–æ–ª–∏—Ç–∏–∫–∞ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏')">–ü–æ–ª–∏—Ç–∏–∫–∞ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏</a>
                <a href="#" onclick="alert('–ü—Ä–∞–≤–∏–ª–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è')">–ü—Ä–∞–≤–∏–ª–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è</a>
            </div>
            <p class="copyright">¬© 2024 Movie Reviews. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.</p>
        </footer>
    </div>
</body>
</html>